#!/usr/bin/sh

# Minutes
TIME=25

notify() {
	SEC=$1
	seconds=$((SEC * 1000))

	sudo -u $USER DISPLAY=:0 \
		DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus \
		notify-send -t "$seconds" "$2"
}

randcowfortune() {
	sleep $((13 * 60))
	notify 17 "$(fortune /usr/share/fortune/vimtips | botsay -)"
}

while true; do
	randcowfortune &
	sleep 5;
	playerctl play
	# notify "$(cowsay -f flaming-sheep üçÖ Pomodoro: Start! Focus on your task.)"
	sleep $((TIME * 60 - 30)) && \
	notify 5 "$(cowsay -t üí§ $(date +%H:%M))" && \
	sleep 30 && \
	slock && \
	playerctl pause
done

